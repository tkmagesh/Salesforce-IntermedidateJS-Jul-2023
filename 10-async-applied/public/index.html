<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async Applied</title>
    <script src="axios.min.js"></script>
    <style>
        body {
            margin-left: 50px;
        }
        ul {
            width : 500px;
            list-style: none;
            -webkit-padding-start: 0px;
        }
        li {
            margin-bottom: 10px;
            padding : 10px;
            border : 1px solid gray;
            border-radius: 5px;
            background-color: #e7e7e7;
        }
    </style>
    <script>
        /*
            //creating a new bug - reference
            const newBugData = {
                id : 0,
                name : 'Test Bug - 2',
                isClosed : false,
                createdAt : new Date()
            }
            axios.post('http://localhost:3000/bugs', newBugData)
                .then(response => {
                    console.log(response.data)  
                })
        */
        //Server communication
        const bugApi = (() => {
            async function getAllBugs() {
                const response = await axios.get('http://localhost:3000/bugs');
                const bugs = response.data
                return bugs;
            }
            return {
                getAllBugs
            };
        })();
        

        //UI
        (function(){
            async function loadBugs(){
                const bugsList = document.getElementById('bugsList')
                const bugs = await bugApi.getAllBugs();
                bugs.forEach(function(bug){
                    const bugItem = document.createElement('li');
                    bugItem.textContent = bug.name
                    bugsList.append(bugItem)
                })
            }

            function onDocumentLoad(){
                loadBugs()
            }
            window.addEventListener('load', onDocumentLoad)
        })();
    </script>
</head>
<body>
    <h1>Bug Tracker</h1>
    <hr>
    <h3>Bugs</h3>
    <label for="">Bug Name :</label>
    <input type="text" name="" id="txtNewBugName">
    <button id="btnAddNew">Add New</button>
    <ul id="bugsList">

    </ul>
</body>
</html>